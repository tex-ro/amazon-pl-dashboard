<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vendor P&L Analytics Dashboard</title>
    <meta name="description" content="Comprehensive Amazon Vendor Central analytics dashboard with ASIN-level profitability tracking">
    
    <!-- React & ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- Recharts from CDN -->
    <script src="https://unpkg.com/recharts@2.5.0/dist/Recharts.js"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: linear-gradient(to bottom right, #f9fafb, #f3f4f6);
            color: #111827;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        .header {
            background: white;
            border-bottom: 1px solid #e5e7eb;
            position: sticky;
            top: 0;
            z-index: 50;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .header-content {
            padding: 1rem 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .header-title {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .logo {
            width: 2.5rem;
            height: 2.5rem;
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo svg {
            width: 1.5rem;
            height: 1.5rem;
            color: white;
        }

        .title-text h1 {
            font-size: 1.5rem;
            font-weight: 700;
            color: #111827;
        }

        .title-text p {
            font-size: 0.875rem;
            color: #6b7280;
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            font-size: 0.875rem;
            cursor: pointer;
            border: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
        }

        .btn svg {
            width: 1rem;
            height: 1rem;
        }

        .btn-primary {
            background: #3b82f6;
            color: white;
        }

        .btn-primary:hover {
            background: #2563eb;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: #374151;
        }

        .btn-secondary:hover {
            background: #e5e7eb;
        }

        .badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.75rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .badge-syncing {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #93c5fd;
        }

        .badge-success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #6ee7b7;
        }

        .badge-error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #fca5a5;
        }

        .tabs {
            border-top: 1px solid #e5e7eb;
            display: flex;
            gap: 1rem;
            overflow-x: auto;
        }

        .tab {
            padding: 1rem;
            font-weight: 600;
            border-bottom: 2px solid transparent;
            cursor: pointer;
            white-space: nowrap;
            text-transform: capitalize;
            color: #6b7280;
            background: none;
            border-top: none;
            border-left: none;
            border-right: none;
        }

        .tab:hover {
            color: #111827;
        }

        .tab.active {
            color: #3b82f6;
            border-bottom-color: #3b82f6;
        }

        .main-content {
            padding: 2rem 0;
        }

        .filter-bar {
            background: white;
            border-radius: 1rem;
            padding: 1rem;
            margin-bottom: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #f3f4f6;
        }

        .filter-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .filter-inputs {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .input, select {
            padding: 0.5rem 0.75rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            background: white;
        }

        .input:focus, select:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-4 {
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        }

        .grid-3 {
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        }

        .card {
            background: white;
            border-radius: 1rem;
            padding: 1.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #f3f4f6;
            transition: all 0.3s;
        }

        .card:hover {
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .metric-card {
            position: relative;
        }

        .metric-header {
            display: flex;
            align-items: start;
            justify-content: space-between;
            margin-bottom: 1rem;
        }

        .metric-icon {
            padding: 0.75rem;
            border-radius: 0.75rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .metric-icon svg {
            width: 1.5rem;
            height: 1.5rem;
            color: white;
        }

        .trend-badge {
            display: flex;
            align-items: center;
            gap: 0.25rem;
            padding: 0.25rem 0.5rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .trend-up {
            background: #d1fae5;
            color: #065f46;
        }

        .trend-down {
            background: #fee2e2;
            color: #991b1b;
        }

        .metric-title {
            font-size: 0.875rem;
            font-weight: 500;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }

        .metric-value {
            font-size: 1.875rem;
            font-weight: 700;
            color: #111827;
        }

        .metric-subtitle {
            font-size: 0.75rem;
            color: #9ca3af;
            margin-top: 0.25rem;
        }

        .gradient-card {
            background: linear-gradient(135deg, var(--from), var(--to));
            color: white;
        }

        .table-container {
            overflow-x: auto;
            margin-top: 1.5rem;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f9fafb;
            border-bottom: 1px solid #e5e7eb;
        }

        th {
            padding: 1rem;
            text-align: left;
            font-size: 0.75rem;
            font-weight: 600;
            color: #6b7280;
            text-transform: uppercase;
        }

        td {
            padding: 1rem;
            border-bottom: 1px solid #f3f4f6;
        }

        tr:hover {
            background: #f9fafb;
        }

        .status-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 700;
        }

        .badge-high {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-medium {
            background: #fef3c7;
            color: #92400e;
        }

        .badge-low {
            background: #fee2e2;
            color: #991b1b;
        }

        .modal {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(4px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            padding: 1rem;
        }

        .modal-content {
            background: white;
            border-radius: 1rem;
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1);
        }

        .modal-header {
            padding: 1.5rem;
            border-bottom: 1px solid #e5e7eb;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 1.5rem;
            font-weight: 700;
        }

        .modal-body {
            padding: 1.5rem;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 1px solid #e5e7eb;
            border-radius: 0.75rem;
            font-size: 0.875rem;
        }

        .form-input:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .upload-area {
            border: 2px dashed #d1d5db;
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .upload-area:hover {
            border-color: #3b82f6;
        }

        .alert-card {
            border-left: 4px solid;
        }

        .alert-low {
            border-left-color: #ef4444;
        }

        .alert-high {
            border-left-color: #10b981;
        }

        .search-box {
            position: relative;
            flex: 1;
            min-width: 200px;
        }

        .search-box svg {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            width: 1.25rem;
            height: 1.25rem;
            color: #9ca3af;
        }

        .search-box input {
            width: 100%;
            padding-left: 2.5rem;
        }

        .spin {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                align-items: stretch;
            }

            .header-actions {
                justify-content: center;
            }

            .grid-4, .grid-3 {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        const { useState, useEffect, useMemo } = React;
        const { PieChart, Pie, Cell, BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer } = Recharts;

        // ASIN Cost Mapping
        const asinCostMapping = {
            'B0FQ2DKLBZ': 950,
            'B0DXK2LP5M': 180,
            'B0CBN7X3V1': 450,
            'B0FLKBTVPM': 85,
            'B0FM454VC4': 1450,
            'B0FHHNK55H': 580,
            'B0C72QSYTL': 970,
            'B0FC687JRP': 75,
            'B0F9VJTFS5': 220,
            'B0CLGJ1Y46': 550,
            'B0F9VJ3T51': 650,
            'B0DSKK7CZX': 115,
        };

        // Sample CSV Data
        const sampleCSVData = [
            { 'Order ID': 'TCb7hhcVk', 'Invoice ID': 'GT/437', 'Invoice date': '28 Oct 2025', ASIN: 'B0FQ2DKLBZ', SKU: 'transparent white drawer 4 layer', 'Item Title': 'TEX-RO Plastic Wardrobe', Quantity: '1', 'Item Cost': '₹1,206.99' },
            { 'Order ID': 'TXyGt1YKk', 'Invoice ID': 'GT/437', 'Invoice date': '28 Oct 2025', ASIN: 'B0DXK2LP5M', SKU: 'jolly basket pack of 6', 'Item Title': 'TEX-RO Storage Box', Quantity: '1', 'Item Cost': '₹226.55' },
            { 'Order ID': 'TNYgWhcMk', 'Invoice ID': 'GT/437', 'Invoice date': '28 Oct 2025', ASIN: 'B0CBN7X3V1', SKU: 'dish racks', 'Item Title': 'TEX-RO Utensils Basket', Quantity: '35', 'Item Cost': '₹594.00' },
            { 'Order ID': 'TDef123Mk', 'Invoice ID': 'GT/438', 'Invoice date': '29 Oct 2025', ASIN: 'B0FLKBTVPM', SKU: 'small basket red', 'Item Title': 'TEX-RO Compact Basket', Quantity: '12', 'Item Cost': '₹105.50' },
            { 'Order ID': 'TABC456Mk', 'Invoice ID': 'GT/439', 'Invoice date': '29 Oct 2025', ASIN: 'B0FM454VC4', SKU: 'premium storage xl', 'Item Title': 'TEX-RO Premium XL Storage', Quantity: '3', 'Item Cost': '₹1,899.00' },
        ];

        const expenseData = {
            advertising: 85000,
            ccogs: 25000,
            vret: 15000,
            freightPerInvoice: 30000
        };

        function VendorDashboard() {
            const [activeTab, setActiveTab] = useState('overview');
            const [selectedVendor, setSelectedVendor] = useState('etrade');
            const [dateRange, setDateRange] = useState({ start: '2025-10-01', end: '2025-10-31' });
            const [syncStatus, setSyncStatus] = useState('idle');
            const [lastSyncTime, setLastSyncTime] = useState(null);
            const [syncedRecords, setSyncedRecords] = useState(new Set());
            const [autoSync, setAutoSync] = useState(false);
            const [searchTerm, setSearchTerm] = useState('');
            const [sortBy, setSortBy] = useState('margin');
            const [showUploadModal, setShowUploadModal] = useState(false);
            const [showExpenseModal, setShowExpenseModal] = useState(false);

            const vendors = [
                { id: 'etrade', name: 'Etrade' },
                { id: 'retailez', name: 'Retailez' },
                { id: 'clicktech', name: 'Clicktech' }
            ];

            // Parse invoice data
            const parseInvoiceData = (csvData) => {
                const invoices = {};
                const asinMetrics = {};
                
                csvData.forEach(row => {
                    const asin = row.ASIN;
                    const invoiceId = row['Invoice ID'];
                    const quantity = parseInt(row.Quantity);
                    const sellingPrice = parseFloat(row['Item Cost'].replace(/[₹,]/g, ''));
                    const cost = asinCostMapping[asin] || 0;
                    
                    if (!invoices[invoiceId]) {
                        invoices[invoiceId] = {
                            invoiceId,
                            date: row['Invoice date'],
                            items: [],
                            totalRevenue: 0,
                            totalCost: 0,
                            synced: syncedRecords.has(`invoice-${invoiceId}`)
                        };
                    }
                    
                    invoices[invoiceId].totalRevenue += sellingPrice * quantity;
                    invoices[invoiceId].totalCost += cost * quantity;
                    
                    if (!asinMetrics[asin]) {
                        asinMetrics[asin] = {
                            asin,
                            sku: row.SKU,
                            title: row['Item Title'],
                            cost,
                            units: 0,
                            revenue: 0,
                            cogs: 0,
                            synced: syncedRecords.has(`asin-${asin}`)
                        };
                    }
                    
                    asinMetrics[asin].units += quantity;
                    asinMetrics[asin].revenue += sellingPrice * quantity;
                    asinMetrics[asin].cogs += cost * quantity;
                });
                
                return { invoices: Object.values(invoices), asinMetrics: Object.values(asinMetrics) };
            };

            const { invoices, asinMetrics } = useMemo(() => parseInvoiceData(sampleCSVData), [syncedRecords]);

            const calculateMetrics = (data, type = 'asin') => {
                const totalRevenue = data.reduce((sum, item) => sum + item.revenue, 0);
                
                return data.map(item => {
                    const revenueShare = item.revenue / totalRevenue;
                    const allocatedAd = expenseData.advertising * revenueShare;
                    const allocatedCCOGS = expenseData.ccogs * revenueShare;
                    const allocatedVRET = expenseData.vret * revenueShare;
                    const allocatedFreight = type === 'invoice' ? expenseData.freightPerInvoice / invoices.length : expenseData.freightPerInvoice * revenueShare;
                    
                    const grossProfit = item.revenue - item.cogs;
                    const totalExpenses = allocatedAd + allocatedCCOGS + allocatedVRET + allocatedFreight;
                    const netProfit = grossProfit - totalExpenses;
                    const margin = ((netProfit / item.revenue) * 100).toFixed(2);
                    const roi = ((netProfit / item.cogs) * 100).toFixed(2);
                    
                    return {
                        ...item,
                        grossProfit,
                        allocatedAd,
                        allocatedCCOGS,
                        allocatedVRET,
                        allocatedFreight,
                        totalExpenses,
                        netProfit,
                        margin: parseFloat(margin),
                        roi: parseFloat(roi)
                    };
                });
            };

            const asinWithMetrics = useMemo(() => calculateMetrics(asinMetrics, 'asin'), [asinMetrics]);
            const invoiceWithMetrics = useMemo(() => calculateMetrics(invoices.map(inv => ({
                ...inv,
                revenue: inv.totalRevenue,
                cogs: inv.totalCost
            })), 'invoice'), [invoices]);

            const syncToGoogleSheets = async () => {
                setSyncStatus('syncing');
                
                try {
                    const syncData = {
                        vendor: selectedVendor,
                        dateRange,
                        timestamp: new Date().toISOString(),
                        asinData: asinWithMetrics,
                        invoiceData: invoiceWithMetrics,
                        expenses: expenseData
                    };

                    await fetch('https://script.google.com/macros/s/AKfycbwal3bIh65hnWv09vsLv7tH0PCH9h2l8OjCYUJjVbwLK09-qceZjM_m8bzRMEq4VPPdng/exec', {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(syncData)
                    });

                    const newSyncedRecords = new Set(syncedRecords);
                    asinWithMetrics.forEach(a => newSyncedRecords.add(`asin-${a.asin}`));
                    invoiceWithMetrics.forEach(inv => newSyncedRecords.add(`invoice-${inv.invoiceId}`));
                    setSyncedRecords(newSyncedRecords);
                    
                    setSyncStatus('success');
                    setLastSyncTime(new Date());
                    setTimeout(() => setSyncStatus('idle'), 3000);
                } catch (error) {
                    setSyncStatus('error');
                    setTimeout(() => setSyncStatus('idle'), 3000);
                }
            };

            const highMargin = asinWithMetrics.filter(a => a.margin >= 20);
            const mediumMargin = asinWithMetrics.filter(a => a.margin >= 10 && a.margin < 20);
            const lowMargin = asinWithMetrics.filter(a => a.margin < 10);
            const lowROI = asinWithMetrics.filter(a => a.roi < 15);
            const highROI = asinWithMetrics.filter(a => a.roi >= 30);

            const marginDistributionData = [
                { name: 'High (≥20%)', value: highMargin.length, fill: '#10b981' },
                { name: 'Medium (10-20%)', value: mediumMargin.length, fill: '#f59e0b' },
                { name: 'Low (<10%)', value: lowMargin.length, fill: '#ef4444' }
            ];

            const topASINsData = asinWithMetrics
                .sort((a, b) => b.netProfit - a.netProfit)
                .slice(0, 10)
                .map(a => ({ name: a.sku.substring(0, 15), profit: a.netProfit }));

            useEffect(() => {
                lucide.createIcons();
            }, [activeTab, syncStatus]);

            return React.createElement('div', null,
                // Header
                React.createElement('div', { className: 'header' },
                    React.createElement('div', { className: 'container' },
                        React.createElement('div', { className: 'header-content' },
                            React.createElement('div', { className: 'header-title' },
                                React.createElement('div', { className: 'logo' },
                                    React.createElement('i', { 'data-lucide': 'bar-chart-3' })
                                ),
                                React.createElement('div', { className: 'title-text' },
                                    React.createElement('h1', null, 'Vendor Central Analytics'),
                                    React.createElement('p', null, 'Invoice & ASIN-level P&L monitoring')
                                )
                            ),
                            React.createElement('div', { className: 'header-actions' },
                                syncStatus === 'syncing' && React.createElement('div', { className: 'badge badge-syncing' },
                                    React.createElement('i', { 'data-lucide': 'refresh-cw', className: 'spin' }),
                                    'Syncing...'
                                ),
                                syncStatus === 'success' && React.createElement('div', { className: 'badge badge-success' },
                                    React.createElement('i', { 'data-lucide': 'check-circle' }),
                                    'Synced!'
                                ),
                                lastSyncTime && React.createElement('div', { style: { fontSize: '0.75rem', color: '#6b7280' } },
                                    `Last synced: ${lastSyncTime.toLocaleTimeString()}`
                                ),
                                React.createElement('button', {
                                    className: 'btn btn-primary',
                                    onClick: syncToGoogleSheets,
                                    disabled: syncStatus === 'syncing'
                                },
                                    React.createElement('i', { 'data-lucide': 'cloud' }),
                                    'Sync to Sheets'
                                ),
                                React.createElement('button', {
                                    className: 'btn btn-success',
                                    onClick: () => setShowUploadModal(true)
                                },
                                    React.createElement('i', { 'data-lucide': 'upload' }),
                                    'Upload Invoice'
                                ),
                                React.createElement('button', {
                                    className: 'btn btn-primary',
                                    onClick: () => setShowExpenseModal(true)
                                },
                                    React.createElement('i', { 'data-lucide': 'plus' }),
                                    'Add Expense'
                                )
                            )
                        ),
                        React.createElement('div', { className: 'tabs' },
                            ['overview', 'asin-analysis', 'invoice-analysis', 'charts', 'roi-alerts'].map(tab =>
                                React.createElement('button', {
                                    key: tab,
                                    className: `tab ${activeTab === tab ? 'active' : ''}`,
                                    onClick: () => setActiveTab(tab)
                                },
                                    tab.replace('-', ' ')
                                )
                            )
                        )
                    )
                ),
                
                // Main Content
                React.createElement('div', { className: 'container main-content' },
                    // Filter Bar
                    React.createElement('div', { className: 'filter-bar' },
                        React.createElement('div', { className: 'filter-content' },
                            React.createElement('div', { className: 'filter-inputs' },
                                React.createElement('i', { 'data-lucide': 'calendar' }),
                                React.createElement('input', {
                                    type: 'date',
                                    className: 'input',
                                    value: dateRange.start,
                                    onChange: (e) => setDateRange({...dateRange, start: e.target.value})
                                }),
                                React.createElement('span', null, 'to'),
                                React.createElement('input', {
                                    type: 'date',
                                    className: 'input',
                                    value: dateRange.end,
                                    onChange: (e) => setDateRange({...dateRange, end: e.target.value})
                                }),
                                React.createElement('select', {
                                    value: selectedVendor,
                                    onChange: (e) => setSelectedVendor(e.target.value)
                                },
                                    vendors.map(v => React.createElement('option', { key: v.id, value: v.id }, v.name))
                                )
                            ),
                            React.createElement('div', { style: { fontSize: '0.875rem', color: '#6b7280' } },
                                React.createElement('i', { 'data-lucide': 'check', style: { width: '1rem', height: '1rem', color: '#10b981', display: 'inline' } }),
                                ` ${syncedRecords.size} records synced`
                            )
                        )
                    ),

                    // Overview Tab
                    activeTab === 'overview' && React.createElement('div', null,
                        React.createElement('div', { className: 'grid grid-4', style: { marginBottom: '2rem' } },
                            React.createElement('div', { className: 'card metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', {
                                        className: 'metric-icon',
                                        style: { background: 'linear-gradient(135deg, #10b981, #059669)' }
                                    },
                                        React.createElement('i', { 'data-lucide': 'dollar-sign' })
                                    ),
                                    React.createElement('div', { className: 'trend-badge trend-up' },
                                        React.createElement('i', { 'data-lucide': 'trending-up' }),
                                        '12.5%'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-title' }, 'Total Revenue'),
                                React.createElement('div', { className: 'metric-value' },
                                    `₹${asinWithMetrics.reduce((s, a) => s + a.revenue, 0).toLocaleString('en-IN')}`
                                ),
                                React.createElement('div', { className: 'metric-subtitle' }, 'From all orders')
                            ),
                            React.createElement('div', { className: 'card metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', {
                                        className: 'metric-icon',
                                        style: { background: 'linear-gradient(135deg, #3b82f6, #2563eb)' }
                                    },
                                        React.createElement('i', { 'data-lucide': 'trending-up' })
                                    ),
                                    React.createElement('div', { className: 'trend-badge trend-up' },
                                        React.createElement('i', { 'data-lucide': 'trending-up' }),
                                        '8.3%'
                                    )
                                ),
                                React.createElement('div', { className: 'metric-title' }, 'Net Profit'),
                                React.createElement('div', { className: 'metric-value' },
                                    `₹${asinWithMetrics.reduce((s, a) => s + a.netProfit, 0).toLocaleString('en-IN')}`
                                )
                            ),
                            React.createElement('div', { className: 'card metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', {
                                        className: 'metric-icon',
                                        style: { background: 'linear-gradient(135deg, #8b5cf6, #7c3aed)' }
                                    },
                                        React.createElement('i', { 'data-lucide': 'shopping-cart' })
                                    )
                                ),
                                React.createElement('div', { className: 'metric-title' }, 'Active ASINs'),
                                React.createElement('div', { className: 'metric-value' }, asinWithMetrics.length),
                                React.createElement('div', { className: 'metric-subtitle' }, `${highMargin.length} high margin`)
                            ),
                            React.createElement('div', { className: 'card metric-card' },
                                React.createElement('div', { className: 'metric-header' },
                                    React.createElement('div', {
                                        className: 'metric-icon',
                                        style: { background: 'linear-gradient(135deg, #f97316, #ea580c)' }
                                    },
                                        React.createElement('i', { 'data-lucide': 'bar-chart-3' })
                                    )
                                ),
                                React.createElement('div', { className: 'metric-title' }, 'Avg ROI'),
                                React.createElement('div', { className: 'metric-value' },
                                    `${(asinWithMetrics.reduce((s, a) => s + a.roi, 0) / asinWithMetrics.length).toFixed(1)}%`
                                )
                            )
                        ),
                        React.createElement('div', { className: 'grid grid-3' },
                            React.createElement('div', {
                                className: 'gradient-card card',
                                style: { '--from': '#10b981', '--to': '#059669' }
                            },
                                React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' } },
                                    React.createElement('h3', { style: { fontSize: '1.125rem', fontWeight: '600' } }, 'High Margin'),
                                    React.createElement('i', { 'data-lucide': 'check-circle' })
                                ),
                                React.createElement('p', { style: { fontSize: '2.25rem', fontWeight: '700', marginBottom: '0.5rem' } }, highMargin.length),
                                React.createElement('p', { style: { opacity: 0.9, fontSize: '0.875rem' } }, 'ASINs ≥20% margin')
                            ),
                            React.createElement('div', {
                                className: 'gradient-card card',
                                style: { '--from': '#f59e0b', '--to': '#d97706' }
                            },
                                React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' } },
                                    React.createElement('h3', { style: { fontSize: '1.125rem', fontWeight: '600' } }, 'Medium Margin'),
                                    React.createElement('i', { 'data-lucide': 'bar-chart-3' })
                                ),
                                React.createElement('p', { style: { fontSize: '2.25rem', fontWeight: '700', marginBottom: '0.5rem' } }, mediumMargin.length),
                                React.createElement('p', { style: { opacity: 0.9, fontSize: '0.875rem' } }, 'ASINs 10-20% margin')
                            ),
                            React.createElement('div', {
                                className: 'gradient-card card',
                                style: { '--from': '#ef4444', '--to': '#dc2626' }
                            },
                                React.createElement('div', { style: { display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '1rem' } },
                                    React.createElement('h3', { style: { fontSize: '1.125rem', fontWeight: '600' } }, 'Low Margin'),
                                    React.createElement('i', { 'data-lucide': 'alert-triangle' })
                                ),
                                React.createElement('p', { style: { fontSize: '2.25rem', fontWeight: '700', marginBottom: '0.5rem' } }, lowMargin.length),
                                React.createElement('p', { style: { opacity: 0.9, fontSize: '0.875rem' } }, 'ASINs <10% margin')
                            )
                        )
                    ),

                    // ASIN Analysis Tab
                    activeTab === 'asin-analysis' && React.createElement('div', { className: 'card' },
                        React.createElement('div', { style: { display: 'flex', gap: '1rem', marginBottom: '1.5rem', flexWrap: 'wrap' } },
                            React.createElement('div', { className: 'search-box' },
                                React.createElement('i', { 'data-lucide': 'search' }),
                                React.createElement('input', {
                                    type: 'text',
                                    className: 'form-input',
                                    placeholder: 'Search ASIN or SKU...',
                                    value: searchTerm,
                                    onChange: (e) => setSearchTerm(e.target.value)
                                })
                            ),
                            React.createElement('select', {
                                value: sortBy,
                                onChange: (e) => setSortBy(e.target.value),
                                className: 'input'
                            },
                                React.createElement('option', { value: 'margin' }, 'Sort by Margin'),
                                React.createElement('option', { value: 'roi' }, 'Sort by ROI'),
                                React.createElement('option', { value: 'revenue' }, 'Sort by Revenue'),
                                React.createElement('option', { value: 'units' }, 'Sort by Units')
                            )
                        ),
                        React.createElement('div', { className: 'table-container' },
                            React.createElement('table', null,
                                React.createElement('thead', null,
                                    React.createElement('tr', null,
                                        ['ASIN', 'Product', 'Units', 'Revenue', 'Net Profit', 'Margin %', 'ROI %'].map(h =>
                                            React.createElement('th', { key: h }, h)
                                        )
                                    )
                                ),
                                React.createElement('tbody', null,
                                    asinWithMetrics
                                        .filter(a => a.asin.toLowerCase().includes(searchTerm.toLowerCase()) || a.sku.toLowerCase().includes(searchTerm.toLowerCase()))
                                        .sort((a, b) => {
                                            if (sortBy === 'margin') return b.margin - a.margin;
                                            if (sortBy === 'roi') return b.roi - a.roi;
                                            if (sortBy === 'revenue') return b.revenue - a.revenue;
                                            if (sortBy === 'units') return b.units - a.units;
                                            return 0;
                                        })
                                        .map(asin => React.createElement('tr', { key: asin.asin },
                                            React.createElement('td', null,
                                                React.createElement('div', { style: { fontWeight: '600' } }, asin.asin),
                                                React.createElement('div', { style: { fontSize: '0.75rem', color: '#6b7280' } }, asin.sku)
                                            ),
                                            React.createElement('td', { style: { maxWidth: '300px' } }, asin.title),
                                            React.createElement('td', { style: { textAlign: 'center', fontWeight: '600' } }, asin.units),
                                            React.createElement('td', { style: { textAlign: 'right', fontWeight: '700' } }, `₹${asin.revenue.toLocaleString('en-IN')}`),
                                            React.createElement('td', { style: { textAlign: 'right', fontWeight: '700' } }, `₹${asin.netProfit.toLocaleString('en-IN')}`),
                                            React.createElement('td', null,
                                                React.createElement('span', {
                                                    className: `status-badge ${asin.margin >= 20 ? 'badge-high' : asin.margin >= 10 ? 'badge-medium' : 'badge-low'}`
                                                }, `${asin.margin}%`)
                                            ),
                                            React.createElement('td', null,
                                                React.createElement('span', { className: 'status-badge', style: { background: '#f3e8ff', color: '#7c3aed' } },
                                                    `${asin.roi}%`
                                                )
                                            )
                                        ))
                                )
                            )
                        )
                    ),

                    // Charts Tab
                    activeTab === 'charts' && React.createElement('div', { className: 'grid grid-3' },
                        React.createElement('div', { className: 'card' },
                            React.createElement('h3', { style: { fontSize: '1.125rem', fontWeight: '700', marginBottom: '1rem' } }, 'Margin Distribution'),
                            React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                React.createElement(PieChart, null,
                                    React.createElement(Pie, {
                                        data: marginDistributionData,
                                        dataKey: 'value',
                                        nameKey: 'name',
                                        cx: '50%',
                                        cy: '50%',
                                        outerRadius: 100,
                                        label: true
                                    })
                                )
                            )
                        ),
                        React.createElement('div', { className: 'card' },
                            React.createElement('h3', { style: { fontSize: '1.125rem', fontWeight: '700', marginBottom: '1rem' } }, 'Top 10 ASINs by Profit'),
                            React.createElement(ResponsiveContainer, { width: '100%', height: 300 },
                                React.createElement(BarChart, { data: topASINsData },
                                    React.createElement(CartesianGrid, { strokeDasharray: '3 3' }),
                                    React.createElement(XAxis, { dataKey: 'name', angle: -45, textAnchor: 'end', height: 100 }),
                                    React.createElement(YAxis, null),
                                    React.createElement(Tooltip, null),
                                    React.createElement(Bar, { dataKey: 'profit', fill: '#3b82f6' })
                                )
                            )
                        )
                    )
                ),

                // Upload Modal
                showUploadModal && React.createElement('div', { className: 'modal', onClick: () => setShowUploadModal(false) },
                    React.createElement('div', { className: 'modal-content', onClick: (e) => e.stopPropagation() },
                        React.createElement('div', { className: 'modal-header' },
                            React.createElement('h3', { className: 'modal-title' }, 'Upload Invoice Data'),
                            React.createElement('button', { className: 'btn btn-secondary', onClick: () => setShowUploadModal(false) }, '×')
                        ),
                        React.createElement('div', { className: 'modal-body' },
                            React.createElement('div', { className: 'upload-area' },
                                React.createElement('i', { 'data-lucide': 'upload', style: { width: '3rem', height: '3rem', margin: '0 auto 1rem', color: '#9ca3af' } }),
                                React.createElement('p', { style: { fontSize: '1.125rem', fontWeight: '600', marginBottom: '0.5rem' } }, 'Drop your CSV here'),
                                React.createElement('input', { type: 'file', accept: '.csv', style: { display: 'none' }, id: 'file-upload' }),
                                React.createElement('label', { htmlFor: 'file-upload', className: 'btn btn-primary', style: { marginTop: '1rem', cursor: 'pointer' } }, 'Choose File')
                            )
                        )
                    )
                ),

                // Expense Modal
                showExpenseModal && React.createElement('div', { className: 'modal', onClick: () => setShowExpenseModal(false) },
                    React.createElement('div', { className: 'modal-content', onClick: (e) => e.stopPropagation() },
                        React.createElement('div', { className: 'modal-header' },
                            React.createElement('h3', { className: 'modal-title' }, 'Add Daily Expenses'),
                            React.createElement('button', { className: 'btn btn-secondary', onClick: () => setShowExpenseModal(false) }, '×')
                        ),
                        React.createElement('div', { className: 'modal-body' },
                            React.createElement('div', { className: 'form-group' },
                                React.createElement('label', { className: 'form-label' }, 'Advertising Spend'),
                                React.createElement('input', { type: 'number', className: 'form-input', placeholder: '0.00' })
                            ),
                            React.createElement('button', { className: 'btn btn-primary', style: { width: '100%' } }, 'Save Expenses')
                        )
                    )
                )
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(VendorDashboard));
    </script>
</body>
</html>
